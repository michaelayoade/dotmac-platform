{% extends "platform_base.html" %}
{% from "components/badges.html" import status_badge %}
{% from "components/empty_state.html" import empty_state %}

{% block header_actions %}
<a href="/servers/new" class="inline-flex items-center gap-2 rounded-lg bg-surface-900 dark:bg-primary-500 px-3.5 py-1.5 text-[13px] font-medium text-white dark:text-surface-950 hover:bg-surface-800 dark:hover:bg-primary-400 transition shadow-sm">
    <svg class="h-4 w-4" fill="none" stroke="currentColor" stroke-width="2" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" d="M12 4.5v15m7.5-7.5h-15"/></svg>
    Add Server
</a>
{% endblock %}

{% block content %}
{% if servers %}
<div class="overflow-x-auto rounded-xl border border-surface-200/80 bg-white dark:border-surface-800/50 dark:bg-surface-900/80 max-h-[calc(100vh-220px)]">
    <table class="min-w-full divide-y divide-surface-100 dark:divide-surface-800/60">
        <thead class="sticky top-0 z-10">
            <tr class="bg-surface-50 dark:bg-surface-800/80 backdrop-blur-sm">
                <th class="px-5 py-3 text-left text-[10px] font-semibold uppercase tracking-[0.15em] text-surface-400 dark:text-surface-500">Server</th>
                <th class="px-5 py-3 text-left text-[10px] font-semibold uppercase tracking-[0.15em] text-surface-400 dark:text-surface-500">Host</th>
                <th class="px-5 py-3 text-left text-[10px] font-semibold uppercase tracking-[0.15em] text-surface-400 dark:text-surface-500">Status</th>
                <th class="px-5 py-3 text-left text-[10px] font-semibold uppercase tracking-[0.15em] text-surface-400 dark:text-surface-500">Instances</th>
                <th class="px-5 py-3 text-left text-[10px] font-semibold uppercase tracking-[0.15em] text-surface-400 dark:text-surface-500">SSH Key</th>
                <th class="px-5 py-3 text-left text-[10px] font-semibold uppercase tracking-[0.15em] text-surface-400 dark:text-surface-500">Type</th>
                <th class="px-5 py-3"></th>
            </tr>
        </thead>
        <tbody class="divide-y divide-surface-100/80 dark:divide-surface-800/40">
            {% for item in servers %}
            {% set s = item.server %}
            <tr class="hover:bg-surface-50/60 dark:hover:bg-surface-800/20 transition-colors">
                <td class="px-5 py-4">
                    <a href="/servers/{{ s.server_id }}" class="text-[13px] font-medium text-surface-900 hover:text-primary-600 dark:text-white dark:hover:text-primary-400 transition">{{ s.name }}</a>
                </td>
                <td class="px-5 py-4 text-[13px] text-surface-500 dark:text-surface-400 font-mono">{{ s.hostname }}:{{ s.ssh_port }}</td>
                <td class="px-5 py-4">
                    {{ status_badge(s.status.value) }}
                </td>
                <td class="px-5 py-4 text-[13px] text-surface-900 dark:text-white font-medium">{{ item.instance_count }}</td>
                <td class="px-5 py-4 text-[12px] text-surface-500 dark:text-surface-400">
                    {% if item.ssh_key_label %}
                        {{ item.ssh_key_label }}
                    {% elif s.ssh_key_id %}
                        assigned
                    {% else %}
                        (none)
                    {% endif %}
                </td>
                <td class="px-5 py-4">
                    {% if s.is_local %}
                        <span class="rounded-md bg-primary-50 px-2 py-0.5 text-[11px] font-medium text-primary-700 dark:bg-primary-900/20 dark:text-primary-400">Local</span>
                    {% else %}
                        <span class="rounded-md bg-surface-100 px-2 py-0.5 text-[11px] font-medium text-surface-500 dark:bg-surface-800 dark:text-surface-400">Remote</span>
                    {% endif %}
                </td>
                <td class="px-5 py-4 text-right">
                    <a href="/servers/{{ s.server_id }}" class="text-[13px] text-surface-400 hover:text-surface-600 dark:text-surface-500 dark:hover:text-surface-300 transition">&rarr;</a>
                </td>
            </tr>
            {% endfor %}
        </tbody>
    </table>
</div>
{% else %}
{{ empty_state(
    title="No servers registered",
    description="Add your first VPS server to start deploying instances.",
    icon='<svg class="h-12 w-12 text-surface-300 dark:text-surface-600" fill="none" stroke="currentColor" stroke-width="1" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" d="M21.75 17.25v-.228a4.5 4.5 0 0 0-.12-1.03l-2.268-9.64a3.375 3.375 0 0 0-3.285-2.602H7.923a3.375 3.375 0 0 0-3.285 2.602l-2.268 9.64a4.5 4.5 0 0 0-.12 1.03v.228m19.5 0a3 3 0 0 1-3 3H5.25a3 3 0 0 1-3-3m19.5 0a3 3 0 0 0-3-3H5.25a3 3 0 0 0-3 3m16.5 0h.008v.008h-.008v-.008Zm-3 0h.008v.008h-.008v-.008Z"/></svg>',
    action_label="Add Server",
    action_url="/servers/new"
) }}
{% endif %}
{% endblock %}
