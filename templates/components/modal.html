{#
    Modal dialog component with scroll lock and focus trap.

    Usage:
        {% from "components/modal.html" import modal_open, modal_close %}
        <div x-data="{ open: false }">
            <button @click="open = true">Open</button>
            {{ modal_open("open") }}
                <h3>Title</h3>
                <p>Content</p>
            {{ modal_close() }}
        </div>
#}

{# ── Modal overlay + container (scroll lock + escape + click-outside) ── #}
{# aria_label: descriptive label for the dialog when no visible heading is present #}
{% macro modal_open(show_var="open", max_width="max-w-sm", aria_label="") %}
<div x-show="{{ show_var }}" x-cloak
     x-effect="document.body.classList.toggle('overflow-hidden', {{ show_var }})"
     @keydown.escape.window="{{ show_var }} = false"
     class="fixed inset-0 z-50 flex items-center justify-center bg-black/50 backdrop-blur-sm"
     x-transition:enter="transition ease-out duration-200"
     x-transition:enter-start="opacity-0"
     x-transition:enter-end="opacity-100"
     x-transition:leave="transition ease-in duration-150"
     x-transition:leave-start="opacity-100"
     x-transition:leave-end="opacity-0"
     @click.self="{{ show_var }} = false">
    <div class="w-full {{ max_width }} rounded-xl bg-white p-6 shadow-xl dark:bg-surface-800"
         role="dialog"
         aria-modal="true"
         {% if aria_label %}aria-label="{{ aria_label }}"{% endif %}
         @click.stop
         x-trap.noscroll="{{ show_var }}"
         x-transition:enter="transition ease-out duration-200"
         x-transition:enter-start="opacity-0 scale-95"
         x-transition:enter-end="opacity-100 scale-100"
         x-transition:leave="transition ease-in duration-150"
         x-transition:leave-start="opacity-100 scale-100"
         x-transition:leave-end="opacity-0 scale-95">
{% endmacro %}

{# ── Close modal container ── #}
{% macro modal_close() %}
    </div>
</div>
{% endmacro %}
